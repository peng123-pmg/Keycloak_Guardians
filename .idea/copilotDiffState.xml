<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/keycloak-server/build.gradle.kts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/keycloak-server/build.gradle.kts" />
              <option name="originalContent" value="plugins {&#10;    id(&quot;io.quarkus&quot;) version &quot;3.15.1&quot;&#10;    kotlin(&quot;jvm&quot;) version &quot;2.0.21&quot;&#10;}&#10;&#10;repositories {&#10;    mavenCentral()&#10;    mavenLocal()&#10;    maven {&#10;        url = uri(&quot;https://repo.mysql.com/&quot;)&#10;    }&#10;}&#10;&#10;java {&#10;    toolchain {&#10;        languageVersion.set(JavaLanguageVersion.of(17))&#10;    }&#10;}&#10;&#10;kotlin {&#10;    jvmToolchain(17)&#10;}&#10;&#10;dependencies {&#10;    implementation(enforcedPlatform(&quot;io.quarkus:quarkus-bom:3.15.1&quot;))&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-reactive&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-oidc&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-kotlin&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-smallrye-jwt&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-reactive-jackson&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-reactive-qute&quot;)&#10;&#10;    // 注意：不添加任何multipart依赖&#10;&#10;    testImplementation(&quot;io.quarkus:quarkus-junit5&quot;)&#10;    testImplementation(&quot;io.rest-assured:rest-assured&quot;)&#10;    testImplementation(&quot;io.quarkus:quarkus-test-security-jwt&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-smallrye-openapi&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.module:jackson-module-kotlin&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-arc&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-flyway&quot;)&#10;&#10;    // Keycloak Admin Client&#10;    implementation(&quot;org.keycloak:keycloak-admin-client:26.4.1&quot;)&#10;    implementation(&quot;org.jboss.resteasy:resteasy-client:6.2.8.Final&quot;)&#10;    implementation(&quot;org.jboss.resteasy:resteasy-jackson2-provider:6.2.8.Final&quot;)&#10;&#10;    // Jackson&#10;    implementation(&quot;com.fasterxml.jackson.core:jackson-databind:2.15.2&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.core:jackson-core:2.15.2&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.core:jackson-annotations:2.15.2&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.module:jackson-module-kotlin:2.15.2&quot;)&#10;&#10;    // MySQL&#10;    implementation(&quot;io.quarkus:quarkus-jdbc-mysql&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-agroal&quot;)&#10;    implementation(&quot;com.mysql:mysql-connector-j:8.3.0&quot;)&#10;    implementation(kotlin(&quot;stdlib-jdk8&quot;))&#10;}&#10;&#10;tasks.withType&lt;JavaCompile&gt; {&#10;    sourceCompatibility = &quot;17&quot;&#10;    targetCompatibility = &quot;17&quot;&#10;}&#10;&#10;tasks.withType&lt;org.jetbrains.kotlin.gradle.tasks.KotlinCompile&gt; {&#10;    compilerOptions {&#10;        jvmTarget.set(org.jetbrains.kotlin.gradle.dsl.JvmTarget.JVM_17)&#10;    }&#10;}&#10;&#10;&#10;" />
              <option name="updatedContent" value="plugins {&#10;    id(&quot;io.quarkus&quot;) version &quot;3.15.1&quot;&#10;    kotlin(&quot;jvm&quot;) version &quot;2.0.21&quot;&#10;}&#10;&#10;repositories {&#10;    mavenCentral()&#10;    mavenLocal()&#10;    maven {&#10;        url = uri(&quot;https://repo.mysql.com/&quot;)&#10;    }&#10;}&#10;&#10;java {&#10;    toolchain {&#10;        languageVersion.set(JavaLanguageVersion.of(17))&#10;    }&#10;}&#10;&#10;kotlin {&#10;    jvmToolchain(17)&#10;}&#10;&#10;dependencies {&#10;    implementation(enforcedPlatform(&quot;io.quarkus:quarkus-bom:3.15.1&quot;))&#10;    implementation(&quot;io.quarkus:quarkus-resteasy&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-oidc&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-kotlin&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-smallrye-jwt&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-jackson&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-qute&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-client&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-client-jackson&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-resteasy-multipart&quot;)&#10;&#10;    // 注意：不添加任何multipart依赖&#10;&#10;    testImplementation(&quot;io.quarkus:quarkus-junit5&quot;)&#10;    testImplementation(&quot;io.rest-assured:rest-assured&quot;)&#10;    testImplementation(&quot;io.quarkus:quarkus-test-security-jwt&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-smallrye-openapi&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.module:jackson-module-kotlin&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-arc&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-flyway&quot;)&#10;&#10;    // Keycloak Admin Client&#10;    implementation(&quot;org.keycloak:keycloak-admin-client:26.4.1&quot;)&#10;    implementation(&quot;org.jboss.resteasy:resteasy-multipart-provider:6.2.9.Final&quot;)&#10;&#10;    // Jackson&#10;    implementation(&quot;com.fasterxml.jackson.core:jackson-databind:2.15.2&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.core:jackson-core:2.15.2&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.core:jackson-annotations:2.15.2&quot;)&#10;    implementation(&quot;com.fasterxml.jackson.module:jackson-module-kotlin:2.15.2&quot;)&#10;&#10;    // MySQL&#10;    implementation(&quot;io.quarkus:quarkus-jdbc-mysql&quot;)&#10;    implementation(&quot;io.quarkus:quarkus-agroal&quot;)&#10;    implementation(&quot;com.mysql:mysql-connector-j:8.3.0&quot;)&#10;    implementation(kotlin(&quot;stdlib-jdk8&quot;))&#10;}&#10;&#10;tasks.withType&lt;JavaCompile&gt; {&#10;    sourceCompatibility = &quot;17&quot;&#10;    targetCompatibility = &quot;17&quot;&#10;}&#10;&#10;tasks.withType&lt;org.jetbrains.kotlin.gradle.tasks.KotlinCompile&gt; {&#10;    compilerOptions {&#10;        jvmTarget.set(org.jetbrains.kotlin.gradle.dsl.JvmTarget.JVM_17)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/keycloak-server/src/main/kotlin/com/example/config/KeycloakConfig.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/keycloak-server/src/main/kotlin/com/example/config/KeycloakConfig.kt" />
              <option name="originalContent" value="package com.example.config&#10;&#10;import jakarta.enterprise.context.ApplicationScoped&#10;import org.eclipse.microprofile.config.inject.ConfigProperty&#10;import org.keycloak.admin.client.Keycloak&#10;import org.keycloak.admin.client.KeycloakBuilder&#10;&#10;@ApplicationScoped&#10;class KeycloakConfig {&#10;    @ConfigProperty(name = &quot;keycloak.server.url&quot;)&#10;    lateinit var serverUrl: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.realm&quot;)&#10;    lateinit var realm: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.admin.client.id&quot;)&#10;    lateinit var adminClientId: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.admin.username&quot;)&#10;    lateinit var adminUsername: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.admin.password&quot;)&#10;    lateinit var adminPassword: String&#10;&#10;    fun getKeycloakInstance(): Keycloak {&#10;        return KeycloakBuilder.builder()&#10;            .serverUrl(serverUrl)&#10;            .realm(&quot;master&quot;)&#10;            .clientId(adminClientId)&#10;            .username(adminUsername)&#10;            .password(adminPassword)&#10;            .build()&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.config&#10;&#10;import jakarta.annotation.PreDestroy&#10;import jakarta.enterprise.context.ApplicationScoped&#10;import org.eclipse.microprofile.config.inject.ConfigProperty&#10;import org.keycloak.admin.client.Keycloak&#10;import org.keycloak.admin.client.KeycloakBuilder&#10;import org.jboss.resteasy.client.jaxrs.ResteasyClient&#10;import org.jboss.resteasy.client.jaxrs.internal.ResteasyClientBuilderImpl&#10;import org.jboss.resteasy.plugins.providers.FormUrlEncodedProvider&#10;&#10;@ApplicationScoped&#10;class KeycloakConfig {&#10;    @ConfigProperty(name = &quot;keycloak.server.url&quot;)&#10;    lateinit var serverUrl: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.realm&quot;)&#10;    lateinit var realm: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.admin.client.id&quot;)&#10;    lateinit var adminClientId: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.admin.username&quot;)&#10;    lateinit var adminUsername: String&#10;&#10;    @ConfigProperty(name = &quot;keycloak.admin.password&quot;)&#10;    lateinit var adminPassword: String&#10;&#10;    private val resteasyClient: ResteasyClient =&#10;        ResteasyClientBuilderImpl()&#10;            .register(FormUrlEncodedProvider())&#10;            .build()&#10;&#10;    fun getKeycloakInstance(): Keycloak {&#10;        return KeycloakBuilder.builder()&#10;            .serverUrl(serverUrl)&#10;            .realm(&quot;master&quot;)&#10;            .clientId(adminClientId)&#10;            .username(adminUsername)&#10;            .password(adminPassword)&#10;            .resteasyClient(resteasyClient)&#10;            .build()&#10;    }&#10;&#10;    @PreDestroy&#10;    fun closeClient() {&#10;        try {&#10;            resteasyClient.close()&#10;        } catch (_: Exception) {&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/keycloak-server/src/main/resources/db/migration/V1__create_files_table.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/keycloak-server/src/main/resources/db/migration/V1__create_files_table.sql" />
              <option name="originalContent" value="CREATE TABLE IF NOT EXISTS files (&#10;    id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,&#10;    owner_id VARCHAR(64) NOT NULL,&#10;    owner_realm VARCHAR(64) NOT NULL DEFAULT 'guardians',&#10;    file_name VARCHAR(255) NOT NULL,&#10;    storage_path VARCHAR(512) NOT NULL,&#10;    mime_type VARCHAR(128) NULL,&#10;    size_bytes BIGINT UNSIGNED NOT NULL DEFAULT 0,&#10;    status VARCHAR(32) NOT NULL DEFAULT 'ACTIVE',&#10;    checksum VARCHAR(128) NULL,&#10;    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,&#10;    deleted_at TIMESTAMP NULL,&#10;    PRIMARY KEY (id),&#10;    INDEX idx_files_owner (owner_id),&#10;    INDEX idx_files_status (status),&#10;    INDEX idx_files_created_at (created_at)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;" />
              <option name="updatedContent" value="CREATE TABLE IF NOT EXISTS files (&#10;    id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,&#10;    owner_id VARCHAR(64) NOT NULL,&#10;    owner_realm VARCHAR(64) NOT NULL DEFAULT 'guardians',&#10;    file_name VARCHAR(255) NOT NULL,&#10;    storage_path VARCHAR(512) NOT NULL,&#10;    mime_type VARCHAR(128) NULL,&#10;    size_bytes BIGINT UNSIGNED NOT NULL DEFAULT 0,&#10;    status VARCHAR(32) NOT NULL DEFAULT 'ACTIVE',&#10;    checksum VARCHAR(128) NULL,&#10;    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,&#10;    deleted_at TIMESTAMP NULL,&#10;    PRIMARY KEY (id),&#10;    INDEX idx_files_owner (owner_id),&#10;    INDEX idx_files_status (status),&#10;    INDEX idx_files_created_at (created_at)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>